<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Test</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .chart-container {
            height: 300px;
            width: 100%;
            max-width: 600px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Dashboard Chart Test</h1>
    
    <div class="chart-section">
        <h2>File Analysis</h2>
        <canvas class="chart-container" data-chart-type="filename_analysis"></canvas>
    </div>
    
    <div class="chart-section">
        <h2>File Size Distribution</h2>
        <canvas class="chart-container" data-chart-type="filesize_analysis"></canvas>
    </div>
    
    <div class="chart-section">
        <h2>Message Analysis</h2>
        <canvas class="chart-container" data-chart-type="message_analysis"></canvas>
    </div>
    
    <script type="application/json" id="chart-data">
    {
        "filename_analysis": {"type": "pie", "data": {"labels": ["Unique Files", "Duplicate Files"], "datasets": [{"label": "File Uniqueness", "data": [1844, 256], "backgroundColor": ["#28a745", "#dc3545"], "borderWidth": 2}]}, "options": {"responsive": true, "plugins": {"title": {"display": true, "text": "File Uniqueness Distribution"}, "legend": {"position": "bottom"}}}},
        "filesize_analysis": {"type": "bar", "data": {"labels": ["10MB+", "1-5MB", "0-1MB", "5-10MB"], "datasets": [{"label": "Number of Files", "data": [1153, 473, 184, 178], "backgroundColor": ["#dc3545", "#28a745", "#17a2b8", "#ffc107"], "borderWidth": 1}]}, "options": {"responsive": true, "plugins": {"title": {"display": true, "text": "File Size Distribution"}, "legend": {"display": false}}, "scales": {"y": {"beginAtZero": true}}}},
        "message_analysis": {"type": "bar", "data": {"labels": ["#1", "#reading", "#esl", "#english", "#languages", "#japan", "#asia", "#article", "#New_scientist", "#magazine"], "datasets": [{"label": "Hashtag Usage", "data": [11, 3, 2, 2, 1, 1, 1, 1, 1, 1], "backgroundColor": "#007bff", "borderColor": "#0056b3", "borderWidth": 1}]}, "options": {"responsive": true, "plugins": {"title": {"display": true, "text": "Top Hashtags"}, "legend": {"display": false}}, "scales": {"y": {"beginAtZero": true}, "x": {"ticks": {"maxRotation": 45}}}}}
    }
    </script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });

        function initializeCharts() {
            // Get chart data from script tag
            const chartDataScript = document.getElementById('chart-data');
            if (!chartDataScript) {
                console.error('Chart data script not found');
                return;
            }
            
            let chartData;
            try {
                chartData = JSON.parse(chartDataScript.textContent);
                console.log('Chart data loaded:', chartData);
            } catch (error) {
                console.error('Error parsing chart data:', error);
                return;
            }
            
            // Initialize Chart.js charts
            const chartElements = document.querySelectorAll('.chart-container');
            console.log('Found chart elements:', chartElements.length);
            
            chartElements.forEach((element, index) => {
                const chartType = element.dataset.chartType;
                console.log('Processing chart element:', chartType, 'element:', element);
                
                if (chartType && chartData[chartType]) {
                    try {
                        const chartConfig = chartData[chartType];
                        console.log('Chart config for', chartType, ':', chartConfig);
                        new Chart(element, chartConfig);
                        console.log('Chart initialized successfully:', chartType);
                    } catch (error) {
                        console.error('Error creating chart for', chartType, ':', error);
                    }
                } else {
                    console.warn('No chart data found for type:', chartType, 'Available types:', Object.keys(chartData));
                }
            });
        }
    </script>
</body>
</html>
